(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{372:function(t,v,_){"use strict";_.r(v);var d=_(42),r=Object(d.a)({},(function(){var t=this,v=t.$createElement,_=t._self._c||v;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h2",{attrs:{id:"arrowlink"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#arrowlink"}},[t._v("#")]),t._v(" arrowLink")]),t._v(" "),_("p",[_("code",[t._v("new FastV.ArrowLink(nodeA, nodeB, config)")])]),t._v(" "),_("h4",{attrs:{id:"参数"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#参数"}},[t._v("#")]),t._v(" 参数")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("参数名")]),t._v(" "),_("th",[t._v("描述")]),t._v(" "),_("th",[t._v("是否必填")]),t._v(" "),_("th",[t._v("例子")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[_("strong",[t._v("nodeA")])]),t._v(" "),_("td",[t._v("起点")]),t._v(" "),_("td",[t._v("必填")]),t._v(" "),_("td",[t._v("{x:100,y:100,width:10,height:10}")])]),t._v(" "),_("tr",[_("td",[_("strong",[t._v("nodeB")])]),t._v(" "),_("td",[t._v("终点")]),t._v(" "),_("td",[t._v("必填")]),t._v(" "),_("td",[t._v("{x:100,y:100,width:10,height:10}")])]),t._v(" "),_("tr",[_("td",[_("strong",[t._v("config")])]),t._v(" "),_("td",[t._v("配置项")]),t._v(" "),_("td",[t._v("非必填")]),t._v(" "),_("td",[_("strong",[t._v("color")]),t._v("： 箭头线颜色")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td",[_("strong",[t._v("direction")]),t._v("：箭头朝向（默认：forward，起点指向重点）forward/backward/both")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td",[_("strong",[t._v("lineWidth")]),t._v("：箭头线粗细（单位px）")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td",[_("strong",[t._v("dashed")]),t._v("：是否为虚线（true：是，false/默认：否）")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td",[_("strong",[t._v("text")]),t._v("：箭头线上文本")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td",[_("strong",[t._v("fontSize")]),t._v("：文本字体大小（默认：12px）")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td",[_("strong",[t._v("fontFamily")]),t._v("：文本的字体（默认：serif）")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td",[_("strong",[t._v("fontColor")]),t._v("：文本颜色（默认：#000）")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td",[_("strong",[t._v("textAlign")]),t._v("：文本左右对齐方式（默认：center）left/right/center")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td",[_("strong",[t._v("textBaseline")]),t._v("：文本的基准线（默认：middle）top/bottom/middle")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td",[_("strong",[t._v("arrowLen")]),t._v("：箭头的长度（默认：10）")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td",[_("strong",[t._v("arrowWidth")]),t._v("：箭头的宽度（默认：5）")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td",[_("strong",[t._v("arrowAngle")]),t._v("：箭头和线之间夹角（默认：45）")])])])]),t._v(" "),_("ul",[_("li",[t._v("首先，传入起始点坐标，canvas translate到起点坐标位置，计算线段相对于x轴旋转角度，旋转整个canvas画布，然后lineto线段的长度来画线段\n"),_("ul",[_("li",[t._v("（为什么不直接画，而是translate到起点然后旋转一定角度？）")]),t._v(" "),_("li",[t._v("因为如果有箭头的话，并且linewidth不是默认，那么会造成如图问题")]),t._v(" "),_("li",[_("img",{attrs:{src:"C:%5CUsers%5C17640%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201109162819700.png",alt:"image-20201109162819700"}})]),t._v(" "),_("li",[t._v("所以如果有右箭头，画线时候缩短箭头宽度的长度，这样旋转canvas画布之后，可以直接"),_("code",[t._v("lineTo(线段长 - 箭头宽, 0)")]),t._v("，有左键头可以"),_("code",[t._v("moveTo(箭头宽, 0)")]),t._v("，然后"),_("code",[t._v("lineTo(线段长, 0)")]),t._v("，如果由两侧箭头则结合以上两种")])])]),t._v(" "),_("li",[t._v("然后根据传入的config参数来判断是需要画起始点箭头还是终止点箭头或者两者都画，箭头方法略")])]),t._v(" "),_("h4",{attrs:{id:"箭头线的拾取方案"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#箭头线的拾取方案"}},[t._v("#")]),t._v(" 箭头线的拾取方案")]),t._v(" "),_("ul",[_("li",[_("p",[t._v("首先获取到canvas中出发点击事件的测试点x和y")])]),t._v(" "),_("li",[_("p",[t._v("计算测试点和起点连线与线段的点积--cross")]),t._v(" "),_("ul",[_("li",[t._v("小于0？说明测试点的垂直线在起点侧延长线上，直接计算测试点与起点两点之间距离")])])]),t._v(" "),_("li",[_("p",[t._v("计算线段自身的点积（也就是线段长度的两倍）--lengthSquare")]),t._v(" "),_("ul",[_("li",[t._v("如果cross比lengthSquare还要大，说明测试点到线段的垂线在终点侧延长线上，计算测试点和终点之间的距离")])])]),t._v(" "),_("li",[_("p",[t._v("以上两种情况都不满足？")]),t._v(" "),_("ul",[_("li",[t._v("说明测试点到线段的垂直线在线段中间，可以直接计算线到直线的距离")])])]),t._v(" "),_("li",[_("p",[_("strong",[t._v("除了以上方案还有另外一种：使用离屏canvas，并且给每个图形增加为一个rgba颜色，通过点击坐标获取颜色来判断")])]),t._v(" "),_("ul",[_("li",[t._v("不过离屏canvas获取颜色方案貌似并不适合path，因为canvas获取到的颜色稍有误差")])]),t._v(" "),_("p",[_("strong",[t._v("（暂时没想到第三种方案，或者对上面两种的优化策略）")])])])]),t._v(" "),_("h2",{attrs:{id:"looplink"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#looplink"}},[t._v("#")]),t._v(" LoopLink")]),t._v(" "),_("p",[t._v("环形线，从当前node指向自身的线")]),t._v(" "),_("p",[_("code",[t._v("new FastV.LoopLink(nodeA,config)")])]),t._v(" "),_("h4",{attrs:{id:"参数-2"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#参数-2"}},[t._v("#")]),t._v(" 参数")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("参数名")]),t._v(" "),_("th",[t._v("描述")]),t._v(" "),_("th",[t._v("是否必填")]),t._v(" "),_("th",[t._v("例子")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("nodeA")]),t._v(" "),_("td",[t._v("起始点")]),t._v(" "),_("td",[t._v("是")]),t._v(" "),_("td",[t._v("{x:100,y:100,width:10,height:10}")])]),t._v(" "),_("tr",[_("td",[t._v("config")]),t._v(" "),_("td",[t._v("可选配置项")]),t._v(" "),_("td",[t._v("否")]),t._v(" "),_("td",[_("strong",[t._v("color:")]),t._v(" 线颜色 ，默认#000")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td",[t._v("**direction：**箭头朝向，默认forward，forward/backward")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td",[t._v("其他暂略，可以参考arrowlink")])])])]),t._v(" "),_("ul",[_("li",[t._v("首先，传入起点坐标，因为looplink采用了二阶贝塞尔曲线，所以需要控制点和终点坐标")]),t._v(" "),_("li",[t._v("现方案为，通过起始点坐标和点的宽高，简单的讲终点坐标设置为"),_("code",[t._v("起始点x+width")]),t._v(",y坐标同理，"),_("code",[t._v("起始点y+height")])]),t._v(" "),_("li",[t._v("控制点简单设置为，"),_("code",[t._v("x = (起始点x * 2 + width)/2")]),t._v(", "),_("code",[t._v("y = (起始点y - height * 5)")]),t._v(",有待修改，确定控制点相对位置，或者需要用户传入？传入坐标或者直接传入一个相对的distance？")]),t._v(" "),_("li",[t._v("根据传入direction，也就是箭头朝向，来画箭头，forward？说明箭头由起点指向终点，将箭头方向设置为，控制点指向终点，backward则是控制点指向起点")])]),t._v(" "),_("h4",{attrs:{id:"looplink的拾取方案"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#looplink的拾取方案"}},[t._v("#")]),t._v(" looplink的拾取方案")]),t._v(" "),_("ul",[_("li",[_("p",[t._v("由于点到曲线距离需要求三次方程，计算起来很难实现，所以采用了切割法（我自己命名，就是取线上均匀分布的尽可能多的点）")])]),t._v(" "),_("li",[_("p",[t._v("将曲线切割为一个个在曲线上的点，尽可能的多切分，然后计算点击点和曲线上各个点之间的距离")])]),t._v(" "),_("li",[_("p",[t._v("looplink切分的份数，根据曲线的长度增加而增加")])]),t._v(" "),_("li",[_("p",[_("strong",[t._v("考虑到切割法还是有一定误差，尝试使用了离屏canvas的方法，发现还是有误差，暂时没想到第三种方案")])])])])])}),[],!1,null,null,null);v.default=r.exports}}]);